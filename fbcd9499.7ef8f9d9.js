(window.webpackJsonp=window.webpackJsonp||[]).push([[154],{208:function(e,t,a){"use strict";a.r(t),a.d(t,"frontMatter",(function(){return l})),a.d(t,"metadata",(function(){return s})),a.d(t,"rightToc",(function(){return c})),a.d(t,"default",(function(){return d}));var n=a(2),i=a(6),o=(a(0),a(214)),r=a(215),p=(a(216),a(217)),l=(a(47),{id:"sharepoint",sidebar_label:"SHAREPOINT",title:"SharePoint Platform Configuration"}),s={unversionedId:"installation-guide/install-bihub-windows/agents/bi-platform-config/sharepoint",id:"installation-guide/install-bihub-windows/agents/bi-platform-config/sharepoint",isDocsHomePage:!1,title:"SharePoint Platform Configuration",description:"There are two ways to access SharePoint data as listed below:",source:"@site/docs/installation-guide/install-bihub-windows/agents/bi-platform-config/sharepoint.md",permalink:"/VV-Docs/docs/installation-guide/install-bihub-windows/agents/bi-platform-config/sharepoint",sidebar_label:"SHAREPOINT",sidebar:"installationGuide",previous:{title:"SAC Platform Configuration",permalink:"/VV-Docs/docs/installation-guide/install-bihub-windows/agents/bi-platform-config/sac"},next:{title:"Looker Platform Configuration",permalink:"/VV-Docs/docs/installation-guide/install-bihub-windows/agents/bi-platform-config/looker"}},c=[],b={rightToc:c};function d(e){var t=e.components,a=Object(i.a)(e,["components"]);return Object(o.b)("wrapper",Object(n.a)({},b,a,{components:t,mdxType:"MDXLayout"}),Object(o.b)("p",null,"There are two ways to access SharePoint data as listed below:"),Object(o.b)("ol",null,Object(o.b)("li",{parentName:"ol"},"Microsoft Graph API"),Object(o.b)("li",{parentName:"ol"},"SharePoint REST API")),Object(o.b)("p",null,"We have integrated SharePoint in our BIHub using the second method."),Object(o.b)("p",null,Object(o.b)("strong",{parentName:"p"},"SharePoint App Registration")),Object(o.b)("p",null,'To register an app in SharePoint,navigate to the "New App Registration" page. The URL of that page will be similar to ',Object(o.b)("a",Object(n.a)({parentName:"p"},{href:"https://yourtenantname.sharepoint.com/_layouts/15/appregnew.aspx"}),"https://yourtenantname.sharepoint.com/_layouts/15/appregnew.aspx"),"."),Object(o.b)("div",{style:{textAlign:"center"}},Object(o.b)(p.a,{mdxType:"Zoom"},Object(o.b)("img",{alt:"App Registeration",src:Object(r.a)("/doc-images/sharepoint/app-register.png")}))),Object(o.b)("p",null,"This will be the client id and client secret, you will be provided in ",Object(o.b)("inlineCode",{parentName:"p"},"config.json"),"."),Object(o.b)("p",null,'Fill the details in that page as per the following table and click "Create".'),Object(o.b)("div",{style:{textAlign:"center"}},Object(o.b)(p.a,{mdxType:"Zoom"},Object(o.b)("img",{alt:"App Registeration Fields",src:Object(r.a)("/doc-images/sharepoint/app-register-fields.png")}))),Object(o.b)("p",null,"Copy the generated Client Id and Client Secret into notepad (or any of your favorite editor) as we will need these later."),Object(o.b)("p",null,'Now,the app is being registered and we need to provide the app with some permissions so that it can access data. In order to do that, navigate to the "appinv.aspx" page (with which you can grant permissions to an app). The URL of that page will be similar to the one given below ',Object(o.b)("a",Object(n.a)({parentName:"p"},{href:"https://yourtenantname.sharepoint.com/_layouts/15/appinv.aspx"}),"https://yourtenantname.sharepoint.com/_layouts/15/appinv.aspx")),Object(o.b)("p",null,'On that page, paste the Client Id in the "App Id" text box and click on "Lookup". This will load the details of the app that we registered previously.'),Object(o.b)("div",{style:{textAlign:"center"}},Object(o.b)(p.a,{mdxType:"Zoom"},Object(o.b)("img",{alt:"AppInv App Details",src:Object(r.a)("/doc-images/sharepoint/appinv-details.png")}))),Object(o.b)("p",null,'In the "Permission Request XML",paste the following XML. This XML says that the app can have full control over the current web (which is all that is needed for this case). If you need to give different permissions,then please take a look at ',Object(o.b)("a",Object(n.a)({parentName:"p"},{href:"https://docs.microsoft.com/en-us/sharepoint/dev/sp-add-ins/add-in-permissions-in-sharepoint"}),"this article")," by Microsoft."),Object(o.b)("div",{style:{textAlign:"center"}},Object(o.b)(p.a,{mdxType:"Zoom"},Object(o.b)("img",{alt:"XML",src:Object(r.a)("/doc-images/sharepoint/xml.png")}))),Object(o.b)("p",null,'Once XMLis added, click on "Create". In the next screen click on "Trust It" and this will mean that the app will have the required permissions.'),Object(o.b)("div",{style:{textAlign:"center"}},Object(o.b)(p.a,{mdxType:"Zoom"},Object(o.b)("img",{alt:"Trust SharePoint App",src:Object(r.a)("/doc-images/sharepoint/trust-app.png")}))),Object(o.b)("p",null,"We need to do OAuth for the user, so we need to set up Azure Active Directory."),Object(o.b)("div",{className:"admonition admonition-important alert alert--info"},Object(o.b)("div",Object(n.a)({parentName:"div"},{className:"admonition-heading"}),Object(o.b)("h5",{parentName:"div"},Object(o.b)("span",Object(n.a)({parentName:"h5"},{className:"admonition-icon"}),Object(o.b)("svg",Object(n.a)({parentName:"span"},{xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"}),Object(o.b)("path",Object(n.a)({parentName:"svg"},{fillRule:"evenodd",d:"M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"})))),"important")),Object(o.b)("div",Object(n.a)({parentName:"div"},{className:"admonition-content"}),Object(o.b)("p",{parentName:"div"},"The below listed steps need to be followed for the registration of the Azure Active Directory:"))),Object(o.b)("p",null,"[x]"," Set up the Application in Azure."),Object(o.b)("p",null,"[x]"," Go to ",Object(o.b)("a",Object(n.a)({parentName:"p"},{href:"https://portal.azure.com"}),"https://portal.azure.com")),Object(o.b)("p",null,"[x]"," Navigate to Azure Active Directory and select App Registrations"),Object(o.b)("ul",null,Object(o.b)("li",{parentName:"ul"},"Click on New Applicant registration.")),Object(o.b)("div",{style:{textAlign:"center"}},Object(o.b)(p.a,{mdxType:"Zoom"},Object(o.b)("img",{alt:"New App Registeration",src:Object(r.a)("/doc-images/sharepoint/new-app-registeration.png")}))),Object(o.b)("p",null,"Set  the  name, type  and  redirect  URI  of  the  application. The type should be  Native  and  the  Redirect  URI  must  be formatted as follows: ",Object(o.b)("inlineCode",{parentName:"p"},"https://servername:port/Redirect"),"."),Object(o.b)("p",null,"Once the data is entered, click on Create. This URI should reflect the SharePoint Agent machine hostname or public IP address and the port at which the new agent instance needs to be created."),Object(o.b)("p",null,"Note the Application ID upon successfully registering the application."),Object(o.b)("div",{style:{textAlign:"center"}},Object(o.b)(p.a,{mdxType:"Zoom"},Object(o.b)("img",{alt:"App registered",src:Object(r.a)("/doc-images/sharepoint/app-registered.png")}))),Object(o.b)("ul",null,Object(o.b)("li",{parentName:"ul"},'Provide this under the key "userclientid" in the ',Object(o.b)("inlineCode",{parentName:"li"},"config.json")," file in the SharePoint agent.")),Object(o.b)("p",null,"Create the Application Secret -> Open the application in Azure Portal. "),Object(o.b)("p",null,"Navigate to ",Object(o.b)("strong",{parentName:"p"},"All Settings -> Keys")," and create a ",Object(o.b)("strong",{parentName:"p"},"new key -> Specify a desired value for the key name")," and note down the value provided."),Object(o.b)("div",{style:{textAlign:"center"}},Object(o.b)(p.a,{mdxType:"Zoom"},Object(o.b)("img",{alt:"Keys",src:Object(r.a)("/doc-images/sharepoint/keys.png")}))),Object(o.b)("p",null,"Note that, this value will be displayed only once and will not be displayed again after we close the blade. This value will be the ",Object(o.b)("strong",{parentName:"p"},"userclientsecret")," in the ",Object(o.b)("inlineCode",{parentName:"p"},"config.json")," file of SharePoint Agent."),Object(o.b)("p",null,"If failed to note down the value, please repeat step two to create a new key."),Object(o.b)("ul",null,Object(o.b)("li",{parentName:"ul"},Object(o.b)("p",{parentName:"li"},Object(o.b)("strong",{parentName:"p"},"Sharepointsite")," = Your sharepoint site url (For eg: ",Object(o.b)("a",Object(n.a)({parentName:"p"},{href:"https://yoursite.sharepoint.com/sites/test"}),"https://yoursite.sharepoint.com/sites/test"),")")),Object(o.b)("li",{parentName:"ul"},Object(o.b)("p",{parentName:"li"},Object(o.b)("strong",{parentName:"p"},"ClientId")," = Client ID Registered in sharepoint app ")),Object(o.b)("li",{parentName:"ul"},Object(o.b)("p",{parentName:"li"},Object(o.b)("strong",{parentName:"p"},"Clientsecret")," = Client Secret Registered in sharepoint app ")),Object(o.b)("li",{parentName:"ul"},Object(o.b)("p",{parentName:"li"},Object(o.b)("strong",{parentName:"p"},"Userclientid")," = Client ID Registered in Azure Portal")),Object(o.b)("li",{parentName:"ul"},Object(o.b)("p",{parentName:"li"},Object(o.b)("strong",{parentName:"p"},"Userclientsecret")," = Client Secret Registered in Azure Portal")),Object(o.b)("li",{parentName:"ul"},Object(o.b)("p",{parentName:"li"},Object(o.b)("strong",{parentName:"p"},"Tokenurl")," = ",Object(o.b)("a",Object(n.a)({parentName:"p"},{href:"https://login.microsoftonline.com/%7Bazure_tenantID%7D/oauth2/token"}),"https://login.microsoftonline.com/{azure_tenantID}/oauth2/token"))),Object(o.b)("li",{parentName:"ul"},Object(o.b)("p",{parentName:"li"},Object(o.b)("strong",{parentName:"p"},"Redirecturl")," = Redirect URL mentioned in Azure Portal")),Object(o.b)("li",{parentName:"ul"},Object(o.b)("p",{parentName:"li"},Object(o.b)("strong",{parentName:"p"},"Resource")," = Your sharepoint domain url(For eg: ",Object(o.b)("inlineCode",{parentName:"p"},"https://yourdomain.sharepoint.com"),")")),Object(o.b)("li",{parentName:"ul"},Object(o.b)("p",{parentName:"li"},Object(o.b)("strong",{parentName:"p"},"Host")," = Your sharepoint domain name without http/https. (For eg: ",Object(o.b)("inlineCode",{parentName:"p"},"yourdomain.sharepoint.com"),")")),Object(o.b)("li",{parentName:"ul"},Object(o.b)("p",{parentName:"li"},Object(o.b)("strong",{parentName:"p"},"Sharepointid")," = 00000003-0000-0ff1-ce00-000000000000 (Common for all)")),Object(o.b)("li",{parentName:"ul"},Object(o.b)("p",{parentName:"li"},Object(o.b)("strong",{parentName:"p"},"Tenantid")," = Tenant ID registered in Azure Portal"))))}d.isMDXComponent=!0}}]);